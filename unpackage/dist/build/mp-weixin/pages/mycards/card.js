(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mycards/card"],{"1a84":function(t,n,o){"use strict";o.r(n);var e=o("a2f3"),a=o("f4bf");for(var c in a)"default"!==c&&function(t){o.d(n,t,(function(){return a[t]}))}(c);o("2ff9");var r,i=o("f0c5"),s=Object(i["a"])(a["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],r);n["default"]=s.exports},"2ff9":function(t,n,o){"use strict";var e=o("74c1"),a=o.n(e);a.a},"74c1":function(t,n,o){},"8ce2":function(t,n,o){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=c(o("80cf")),a=o("064b");function c(t){return t&&t.__esModule?t:{default:t}}var r=120,i={onPullDownRefresh:function(){var n=this;(0,a.queryCard)(2,this.grpId,this.cardId).then((function(o){t.stopPullDownRefresh(),n.cardInfo=o.cardOwnList[0],n.cardFunctions[3].content=10==n.cardInfo.cardTypePo.discount?"无":n.cardInfo.cardTypePo.discount,n.cardFunctions[0].content="0",n.cardFunctions[1].content=n.cardInfo.custInfo.currPoints,n.cardInfo.cardTypePo.beginDate=n.formatDate(n.cardInfo.cardTypePo.beginDate),n.cardInfo.cardTypePo.expDate=n.formatDate(n.cardInfo.cardTypePo.expDate)})),(0,a.countOfGrp)(this.grpId).then((function(t){n.cardFunctions[2].content=t.data.use,0!==t.data.closeExpired&&(n.cardFunctions[2].tips=t.data.closeExpired+"张快过期")}))},onLoad:function(t){var n=this;t.cardId&&t.grpId&&(this.grpId=t.grpId,(0,a.queryCard)(2,t.grpId,t.cardId).then((function(t){n.cardInfo=t.cardOwnList[0],n.cardFunctions[3].content=10==n.cardInfo.cardTypePo.discount?"无":n.cardInfo.cardTypePo.discount,n.cardFunctions[0].content="0",n.cardFunctions[1].content=n.cardInfo.custInfo.currPoints,n.cardInfo.cardTypePo.beginDate=n.formatDate(n.cardInfo.cardTypePo.beginDate),n.cardInfo.cardTypePo.expDate=n.formatDate(n.cardInfo.cardTypePo.expDate)})),(0,a.countOfGrp)(this.grpId).then((function(t){n.cardFunctions[2].content=t.data.use,0!==t.data.closeExpired&&(n.cardFunctions[2].tips=t.data.closeExpired+"张快过期")}))),this.color=this.BASECOLOR,this.ossDownloadUrl=this.HTTPCONFIG.ossDownloadUrl},filters:{to4Dfs:function(t){return t&&(t=t.replace(/(.{4})/g,"$1 ")),t}},data:function(){return{ossDownloadUrl:"",timeout:r,color:"",height:250,width:250,cardInfo:"",grpId:"",payToken:"",cardFunctions:[{title:"余额",content:"199.20",path:""},{title:"积分",content:"256",path:"/pages/mycards/myPoints"},{title:"优惠券(张)",content:"0",tips:"",path:"/pages/mycoupon/mycoupons"},{title:"折扣",content:"9.5",path:""}],myTools:[{title:"我的账单",icon:"iconzhangdan",path:"/pages/mycards/myTrans",color:"#00aa00"},{title:"个人资料",icon:"iconziliao",path:"/pages/mycards/myData",color:"#3895ff"},{title:"设置",icon:"iconsettings",path:"/pages/mycards/mySetting",color:"#dda50f"}],tempFilePath:"",showCode:!1}},Timer:function(){},onUnload:function(){clearInterval(this.Timer)},methods:{formatDate:function(t){return t?t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6):""},toDetail:function(t,n){2!=t&&1!=t?3!=t&&0!=t&&this.COMMONFUNCTION.toPage(n):this.COMMONFUNCTION.toPage(n+"?grpId="+this.grpId)},toToolDetail:function(t,n){0!=t?1!=t?this.COMMONFUNCTION.toPage(n):this.COMMONFUNCTION.toPage(n+"?grpCode="+this.grpId+"&custCode="+this.cardInfo.custInfo.custCode):this.COMMONFUNCTION.toPage(n+"?grpId="+this.grpId)},showQrCode:function(){var t=this;(0,a.showPayCode)(this.cardInfo.custInfo.custCode,r+30).then((function(n){clearInterval(t.Timer),t.payToken=n.payToken,t.createQrCode(n.payToken,"mycanvas",t.height,t.width)})).catch((function(n){t.showError(n)}))},createQrCode:function(t,n,o,a){var c=this;e.default.api.draw(t,n,o,a),setTimeout((function(){c.canvasToTempImage(),c.showModal()}),0)},hideModal:function(){this.showCode=!1,clearInterval(this.Timer),this.timeout=r},showModal:function(){this.setTimerOut(),this.showCode=!0},canvasToTempImage:function(){var n=this;t.canvasToTempFilePath({canvasId:"mycanvas",success:function(t){n.tempFilePath=t.tempFilePath}})},Timer:function(){},setTimerOut:function(){var t=this,n=r;this.Timer=setInterval((function(){n<=0?t.showQrCode():(n--,t.timeout=n)}),1e3)},showError:function(t){console.log(t),t instanceof Object?this.$refs.notify.show(t.rcDetail,this.COLORCONFIG.danger):t instanceof String?this.$refs.notify.show(t,this.COLORCONFIG.danger):this.$refs.notify.show("未知错误",this.COLORCONFIG.danger)}}};n.default=i}).call(this,o("543d")["default"])},a2f3:function(t,n,o){"use strict";var e,a=function(){var t=this,n=t.$createElement,o=(t._self._c,t._f("to4Dfs")(t.cardInfo.cardCode)),e=t._f("to4Dfs")(t.payToken);t.$mp.data=Object.assign({},{$root:{f0:o,f1:e}})},c=[];o.d(n,"b",(function(){return a})),o.d(n,"c",(function(){return c})),o.d(n,"a",(function(){return e}))},b4e0:function(t,n,o){"use strict";(function(t){o("e525"),o("921b");e(o("66fd"));var n=e(o("1a84"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,o("543d")["createPage"])},f4bf:function(t,n,o){"use strict";o.r(n);var e=o("8ce2"),a=o.n(e);for(var c in e)"default"!==c&&function(t){o.d(n,t,(function(){return e[t]}))}(c);n["default"]=a.a}},[["b4e0","common/runtime","common/vendor"]]]);